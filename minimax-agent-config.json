{
  "agent_config": {
    "name": "Logistics Ecosystem Developer",
    "version": "1.0.0",
    "description": "AI agent for dual-purpose logistics platform development with security compliance",
    "language": "en",
    "primary_language": "kotlin",
    "frameworks": ["spring-boot", "react", "kubernetes"]
  },
  
  "project_context": {
    "type": "logistics-ecosystem",
    "architecture": "microservices",
    "deployment": "kubernetes",
    "compliance": ["FedRAMP", "CMMC Level 3", "GDPR", "CSRD", "NIST 800-171"],
    "dual_purpose": {
      "civilian_mode": true,
      "strategic_mode": true,
      "switch_capability": "required"
    }
  },

  "technology_stack": {
    "backend": {
      "primary": "kotlin",
      "frameworks": ["spring-boot", "spring-security", "spring-cloud"],
      "databases": ["postgresql", "postgis", "redis"],
      "messaging": ["kafka", "rabbitmq"],
      "api": ["rest", "grpc", "graphql"]
    },
    "frontend": {
      "web": ["react", "typescript", "tailwindcss"],
      "mobile": ["kotlin-multiplatform", "compose-multiplatform"],
      "desktop": ["kotlin-multiplatform", "compose-desktop"]
    },
    "infrastructure": {
      "orchestration": "kubernetes",
      "cloud": ["aws-govcloud", "azure-government"],
      "monitoring": ["prometheus", "grafana", "elk-stack"],
      "security": ["vault", "istio", "cert-manager"]
    }
  },

  "microservices": [
    {
      "name": "OMS",
      "full_name": "Order Management System",
      "description": "Управление жизненным циклом заказов",
      "technologies": ["kotlin", "spring-boot", "postgresql"]
    },
    {
      "name": "WMS",
      "full_name": "Warehouse Management System",
      "description": "Управление складскими операциями, RFID, AGV",
      "technologies": ["kotlin", "spring-boot", "rabbitmq", "iot"]
    },
    {
      "name": "TMS",
      "full_name": "Transportation Management System",
      "description": "Планирование и исполнение перевозок",
      "technologies": ["kotlin", "spring-boot", "postgis", "here-maps"]
    },
    {
      "name": "FMS",
      "full_name": "Fleet Management System",
      "description": "Мониторинг и управление автопарком",
      "technologies": ["kotlin", "spring-boot", "iot", "telemetry"]
    },
    {
      "name": "DroneFleetController",
      "full_name": "Drone Fleet Controller",
      "description": "Управление дронами: миссии, зарядка, безопасность",
      "technologies": ["kotlin", "ros", "computer-vision"]
    },
    {
      "name": "AutonomousService",
      "full_name": "Autonomous Vehicle Service",
      "description": "Логика для беспилотных ТС: V2X, геозоны",
      "technologies": ["kotlin", "tensorflow", "v2x-protocols"]
    },
    {
      "name": "SCM",
      "full_name": "Security & Compliance Module",
      "description": "Кибербезопасность, аудит, RBAC, GDPR",
      "technologies": ["kotlin", "spring-security", "vault", "fips-encryption"]
    },
    {
      "name": "ESG",
      "full_name": "ESG Compliance Service",
      "description": "Углеродный след, CSRD отчётность, циркулярная экономика",
      "technologies": ["kotlin", "analytics", "reporting"]
    },
    {
      "name": "RMS",
      "full_name": "Returns Management System",
      "description": "Обработка возвратов от клиентов",
      "technologies": ["kotlin", "spring-boot", "kafka"]
    },
    {
      "name": "YMS",
      "full_name": "Yard Management System",
      "description": "Координация движения на территории хабов",
      "technologies": ["kotlin", "postgis", "real-time"]
    },
    {
      "name": "IntegrationGateway",
      "full_name": "Integration Gateway",
      "description": "Единая точка подключения к внешним системам",
      "technologies": ["kotlin", "camel", "edi", "xml"]
    },
    {
      "name": "AIMLEngine",
      "full_name": "AI/ML Analytics Engine",
      "description": "Прогнозирование, оптимизация, anomaly detection",
      "technologies": ["python", "tensorflow", "scikit-learn"]
    }
  ],

  "security_requirements": {
    "authentication": {
      "methods": ["jwt", "oauth2", "mtls"],
      "mfa_required": true,
      "session_timeout": 3600
    },
    "authorization": {
      "model": "RBAC + ABAC",
      "roles": ["SUPERADMIN", "DISPATCHER", "WAREHOUSE_MANAGER", "SOC_ANALYST", "DRIVER", "3PL_PARTNER"],
      "context_aware": true
    },
    "encryption": {
      "at_rest": "AES-256-GCM (FIPS 140-2)",
      "in_transit": "TLS 1.3",
      "key_management": "HashiCorp Vault"
    },
    "audit": {
      "all_actions": true,
      "immutable_logs": true,
      "retention": "7 years",
      "format": "CEF (Common Event Format)"
    },
    "compliance_checks": {
      "cmmc_level_3": true,
      "fedramp_moderate": true,
      "gdpr": true,
      "nist_800_171": true
    }
  },

  "code_generation_rules": {
    "general": [
      "Always use dependency injection",
      "Follow SOLID principles",
      "Write unit tests with >80% coverage",
      "Include integration tests for critical paths",
      "Document all public APIs",
      "Use structured error handling",
      "Include correlation IDs for tracing"
    ],
    "security": [
      "NEVER hardcode credentials",
      "Always validate input",
      "Implement rate limiting",
      "Use parameterized queries (prevent SQL injection)",
      "Sanitize all user input",
      "Log security events",
      "Implement CSRF protection",
      "Use Content Security Policy (CSP)"
    ],
    "architecture": [
      "Microservices must be independently deployable",
      "Use event-driven architecture with Kafka",
      "Implement circuit breakers",
      "Add health checks and readiness probes",
      "Support horizontal scaling",
      "Implement graceful shutdown",
      "Use API versioning"
    ],
    "dual_purpose": [
      "Every component supports civilian and strategic modes",
      "Mode switching requires elevated privileges",
      "Log all mode switches",
      "Strategic mode can override civilian operations",
      "Display current mode in UI prominently"
    ]
  },

  "naming_conventions": {
    "services": "PascalCase (OrderManagementSystem)",
    "endpoints": "kebab-case (/api/v1/order-management)",
    "variables": "camelCase (orderId, vehicleStatus)",
    "constants": "UPPER_SNAKE_CASE (MAX_RETRIES, DEFAULT_TIMEOUT)",
    "database_tables": "snake_case (order_items, vehicle_telemetry)",
    "kafka_topics": "dot.notation (orders.created, fleet.telemetry)"
  },

  "code_templates": {
    "kotlin_service": {
      "template": "spring_boot_service",
      "includes": [
        "dependency_injection",
        "error_handling",
        "audit_logging",
        "rbac_annotations",
        "validation",
        "tests"
      ]
    },
    "rest_controller": {
      "template": "rest_controller",
      "includes": [
        "openapi_annotations",
        "validation",
        "authorization",
        "correlation_id",
        "error_responses"
      ]
    },
    "kafka_listener": {
      "template": "kafka_consumer",
      "includes": [
        "error_handling",
        "dead_letter_queue",
        "idempotency",
        "retry_logic"
      ]
    }
  },

  "ui_dashboards": [
    {
      "name": "MainOperationalDashboard",
      "role": "DISPATCHER",
      "description": "Карта ЕС с ТС/дронами, заказы, алерты SCM",
      "features": ["real_time_map", "vehicle_tracking", "order_status", "security_alerts", "mode_switcher"]
    },
    {
      "name": "RoutePlannerDashboard",
      "role": "DISPATCHER",
      "description": "Создание маршрутов с учётом геозон, выбросов",
      "features": ["route_optimization", "geofence_validation", "carbon_calculation", "weather_integration"]
    },
    {
      "name": "WarehouseMonitoringDashboard",
      "role": "WAREHOUSE_MANAGER",
      "description": "Состояние автоматизированных складов",
      "features": ["inventory_status", "agv_tracking", "incident_management", "rfid_integration"]
    },
    {
      "name": "DroneManagementPanel",
      "role": "DRONE_OPERATOR",
      "description": "Карта и миссии дронов",
      "features": ["mission_control", "geofence_zones", "weather_data", "battery_status", "flight_logs"]
    },
    {
      "name": "CybersecurityPanel",
      "role": "SOC_ANALYST",
      "description": "Алерты, аудит, карты доступа, GDPR",
      "features": ["security_alerts", "audit_logs", "access_maps", "compliance_status", "incident_response"]
    },
    {
      "name": "StrategicModePanel",
      "role": "STRATEGIC_MANAGER",
      "description": "Активация стратегического режима",
      "features": ["mode_activation", "resource_reallocation", "priority_override", "legal_documentation"]
    },
    {
      "name": "ESGDashboard",
      "role": "ESG_MANAGER",
      "description": "Углеродный след, рециркуляция, CSRD",
      "features": ["carbon_footprint", "recycling_metrics", "csrd_reports", "circular_economy"]
    },
    {
      "name": "LSPPartnerPortal",
      "role": "3PL_PARTNER",
      "description": "Видимость заказов партнёра",
      "features": ["order_visibility", "documents", "status_tracking", "billing"]
    }
  ],

  "key_user_flows": [
    {
      "name": "SecurityThreatResponse",
      "steps": [
        "SCM generates security alert",
        "Dispatcher reviews alert",
        "Activate strategic mode",
        "Reassign drones/vehicles",
        "Log all actions in audit",
        "Notify relevant parties"
      ],
      "services_involved": ["SCM", "OperationalModeController", "DroneFleetController", "FMS"]
    },
    {
      "name": "ReverseLogisticsAndRecycling",
      "steps": [
        "Customer initiates return (mobile app)",
        "Warehouse receives and certifies item",
        "Plan reverse route",
        "Schedule drone/vehicle pickup",
        "Update LSP portal",
        "Record ESG metrics"
      ],
      "services_involved": ["RMS", "RWS", "RLP", "DroneFleetController", "ESG"]
    },
    {
      "name": "PolicyAdministration",
      "steps": [
        "Admin configures geofence in admin panel",
        "System validates policy",
        "Dispatcher blocks affected routes",
        "Log policy change in SCM",
        "Notify affected parties"
      ],
      "services_involved": ["GeofenceService", "TMS", "SCM", "NotificationService"]
    }
  ],

  "integration_endpoints": {
    "commercial": [
      {
        "name": "SAP",
        "protocols": ["rest", "soap"],
        "auth": "oauth2"
      },
      {
        "name": "Oracle",
        "protocols": ["rest", "jdbc"],
        "auth": "basic"
      },
      {
        "name": "Shopify",
        "protocols": ["rest", "graphql"],
        "auth": "api_key"
      }
    ],
    "government": [
      {
        "name": "ACE (US Customs)",
        "protocols": ["edi", "xml"],
        "auth": "certificate"
      },
      {
        "name": "FEMA LMD",
        "protocols": ["rest"],
        "auth": "mtls"
      },
      {
        "name": "DoD DELTA/eFAST",
        "protocols": ["rest", "soap"],
        "auth": "pki"
      }
    ]
  },

  "geographic_restrictions": {
    "data_residency": {
      "enabled": true,
      "per_country_rules": true,
      "dynamic_exclusion": true
    },
    "routing_constraints": {
      "geofence_validation": "required",
      "blocked_areas": "configurable",
      "real_time_updates": true
    }
  },

  "testing_requirements": {
    "unit_tests": {
      "coverage_minimum": 80,
      "framework": "junit5",
      "mocking": "mockk"
    },
    "integration_tests": {
      "required": true,
      "framework": "testcontainers",
      "database": "postgres"
    },
    "security_tests": {
      "sast": "sonarqube",
      "dast": "owasp-zap",
      "dependency_check": "snyk"
    },
    "performance_tests": {
      "tool": "gatling",
      "load_requirements": {
        "concurrent_users": 10000,
        "response_time_p95": "200ms",
        "throughput": "1000 req/s"
      }
    }
  },

  "deployment": {
    "strategy": "canary",
    "rollback_automatic": true,
    "health_checks": "required",
    "zero_downtime": true,
    "blue_green": "supported"
  },

  "monitoring": {
    "metrics": ["prometheus", "micrometer"],
    "tracing": "opentelemetry",
    "logging": "elk-stack",
    "alerting": "prometheus-alertmanager",
    "dashboards": "grafana"
  },

  "documentation_requirements": {
    "api_docs": "openapi/swagger",
    "architecture": "c4-diagrams",
    "decisions": "adr (Architecture Decision Records)",
    "security": "ssp (System Security Plan)",
    "compliance": ["FedRAMP Authorization Package", "CMMC Assessment Report"]
  },

  "prohibited_practices": [
    "Hardcoded credentials or secrets",
    "Direct database access from UI",
    "Bypassing authentication/authorization",
    "Logging sensitive PII without redaction",
    "Using deprecated dependencies",
    "Skipping security scans",
    "Deploying without tests",
    "Storing unencrypted sensitive data"
  ],

  "prompts": {
    "system_prompt": "You are an expert software architect specializing in secure, scalable logistics systems. You follow microservices architecture, implement strict security controls (CMMC Level 3, FedRAMP, GDPR), and write production-ready code in Kotlin with Spring Boot. Always include proper error handling, audit logging, and security considerations.",
    
    "custom_commands": [
      {
        "name": "/microservice",
        "description": "Generate a complete microservice",
        "prompt": "Create a Spring Boot microservice in Kotlin with the following requirements: 1) Dependency injection, 2) RBAC with @PreAuthorize annotations, 3) Immutable audit logging, 4) Dual-mode support (civilian/strategic), 5) REST API with OpenAPI docs, 6) Unit tests >80% coverage, 7) Integration tests with Testcontainers, 8) Circuit breaker pattern, 9) Correlation ID for tracing, 10) Health checks. Service name: {name}"
      },
      {
        "name": "/security-review",
        "description": "Review code for security compliance",
        "prompt": "Review this code for CMMC Level 3 and GDPR compliance. Check for: 1) FIPS 140-2 encryption, 2) Proper RBAC/ABAC, 3) Input validation, 4) SQL injection prevention, 5) Audit logging, 6) Secrets management, 7) Rate limiting, 8) Error handling without exposing internals, 9) CSRF protection, 10) Data minimization (GDPR)"
      },
      {
        "name": "/test-suite",
        "description": "Generate comprehensive tests",
        "prompt": "Generate a complete test suite including: 1) Unit tests with JUnit 5 and MockK (>80% coverage), 2) Integration tests with Testcontainers, 3) Security tests (auth/authz), 4) API contract tests, 5) Edge cases and error scenarios, 6) Performance tests if applicable. Test class for: {class_name}"
      },
      {
        "name": "/dashboard",
        "description": "Create a dashboard component",
        "prompt": "Create a React dashboard component with TypeScript including: 1) Real-time WebSocket updates, 2) Operational mode indicator (civilian/strategic), 3) Role-based feature visibility, 4) Responsive design with Tailwind CSS, 5) Error boundaries, 6) Loading states, 7) Accessibility (WCAG 2.1), 8) State management with hooks. Dashboard: {dashboard_name}"
      },
      {
        "name": "/integration",
        "description": "Create integration client",
        "prompt": "Create an integration client for external system with: 1) Circuit breaker (Resilience4j), 2) Retry logic with exponential backoff, 3) Rate limiting, 4) Correlation ID propagation, 5) Error handling and fallback, 6) Monitoring metrics, 7) Dead letter queue for failures, 8) Authentication handling. System: {system_name}"
      },
      {
        "name": "/kafka-consumer",
        "description": "Generate Kafka consumer",
        "prompt": "Create a Kafka consumer with: 1) Error handling, 2) Dead letter topic, 3) Idempotency checks, 4) Retry configuration, 5) Graceful shutdown, 6) Monitoring metrics, 7) Deserialization error handling, 8) Audit logging. Topic: {topic_name}"
      },
      {
        "name": "/mobile-screen",
        "description": "Generate mobile screen (KMP)",
        "prompt": "Create a Kotlin Multiplatform screen with Compose including: 1) Shared ViewModel, 2) Platform-specific features (camera, barcode), 3) Offline-first architecture, 4) State management, 5) Error handling, 6) Loading indicators, 7) Pull-to-refresh, 8) Navigation. Screen: {screen_name}"
      }
    ]
  },

  "examples": {
    "service_template": "Generate a complete Spring Boot service with all security and compliance requirements",
    "controller_template": "Generate a REST controller with OpenAPI docs, validation, and authorization",
    "kafka_template": "Generate a Kafka listener with error handling and retry logic",
    "ui_template": "Generate a React dashboard with real-time updates and mode switching",
    "test_template": "Generate comprehensive test suite with unit, integration, and security tests"
  },

  "metadata": {
    "created": "2025-01-03",
    "version": "1.0.0",
    "author": "Logistics Ecosystem Team",
    "last_updated": "2025-01-03"
  }
}